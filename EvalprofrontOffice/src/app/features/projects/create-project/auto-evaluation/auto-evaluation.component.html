<div class="step3-wrapper">
    <div class="step3-card">
        <!-- Header -->
        <div class="header-section">
            <h1 class="main-title"> AUTO Évaluation</h1>
            <p class="subtitle">
                Complétez les 3 piliers pour analyser votre projet. Chaque pilier a sa propre évaluation et progression.
            </p>
        </div>
        <!-- ✅ Message SUCCÈS -->
        <div *ngIf="scores && !hasAnyPillarFailed()" class="alert alert-success">
            Bravo, votre évaluation est complète. Vous pouvez l’évaluer en cliquant sur "J’évalue mon projet"
        </div>

        <!-- ❌ Message ERREUR si un pilier échoue -->
        <div *ngIf="scores && hasAnyPillarFailed()" class="alert alert-danger">
            Votre projet ne dépasse pas le seuil requis sur un ou plusieurs piliers. Il est donc considéré comme non durable. Vous pouvez le modifier et réévaluer, ou créer un nouveau projet.
        </div>

        <!-- Section des piliers -->
        <div class="pillars-section">
            <!-- Pilier ÉCONOMIQUE -->
            <div class="pillar-card economic" (click)="navigateTo('economique')">
                <div class="pillar-number">1</div>
                <div class="pillar-content">
                    <h3 class="pillar-title">Pilier économique</h3>
                    <p class="pillar-description">Apportez de la valeur et diversifiez vos revenus.</p>

                    <!-- ✅ Score intégré ici -->
                    <div class="score-inline" *ngIf="scores?.economique"
                        [ngClass]="{'text-danger': scores.economique.score < scores.economique.threshold}">
                        Score : {{ scores.economique.score }}/{{ scores.economique.max }}<br>
                        Seuil : {{ scores.economique.threshold }}
                    </div>


                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" [style.width.%]="progress.economique"></div>
                        </div>
                        <span class="progress-value">{{ progress.economique }}%</span>
                    </div>
                </div>
                <div class="pillar-icon"><i class="fas fa-chart-line"></i></div>
            </div>


            <!-- Pilier SOCIO -->
            <div class="pillar-card social" (click)="navigateTo('socio')">
                <div class="pillar-number">2</div>
                <div class="pillar-content">
                    <h3 class="pillar-title">Pilier socio territorial</h3>
                    <p class="pillar-description">Renforcez l'emploi et le lien avec le territoire.</p>

                    <!-- ✅ Score intégré ici -->
                    <div class="score-inline" *ngIf="scores?.socio_territorial"
                        [ngClass]="{'text-danger': scores.socio_territorial.score < scores.socio_territorial.threshold}">
                        Score : {{ scores.socio_territorial.score }}/{{ scores.socio_territorial.max }}<br>
                        Seuil : {{ scores.socio_territorial.threshold }}
                    </div>

                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" [style.width.%]="progress.socio"></div>
                        </div>
                        <span class="progress-value">{{ progress.socio }}%</span>
                    </div>
                </div>
                <div class="pillar-icon"><i class="fas fa-users"></i></div>
            </div>


            <!-- Pilier ENVIRONNEMENT -->
            <div class="pillar-card environmental" (click)="navigateTo('environnemental')">
                <div class="pillar-number">3</div>
                <div class="pillar-content">
                    <h3 class="pillar-title">Pilier environnemental</h3>
                    <p class="pillar-description">Réduisez les impacts environnementaux.</p>

                    <!-- ✅ Score intégré ici -->
                    <div class="score-inline" *ngIf="scores?.environnemental"
                        [ngClass]="{'text-danger': scores.environnemental.score < scores.environnemental.threshold}">
                        Score : {{ scores.environnemental.score }}/{{ scores.environnemental.max }}<br>
                        Seuil : {{ scores.environnemental.threshold }}
                    </div>


                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" [style.width.%]="progress.environnemental"></div>
                        </div>
                        <span class="progress-value">{{ progress.environnemental }}%</span>
                    </div>
                </div>
                <div class="pillar-icon"><i class="fas fa-leaf"></i></div>
            </div>



        </div>

        <!-- Bouton -->
        <div class="bottom-right-button">
            <button (click)="goBack()"> Valider</button>
        </div>
        <!-- Bouton J’évalue mon projet -->
        <div class="left-button">
            <button (click)="loadScores()">✔ J’évalue mon projet</button>
             
        </div>
     


    </div>
</div>